!function(e){var n={};function s(o){if(n[o])return n[o].exports;var t=n[o]={i:o,l:!1,exports:{}};return e[o].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=n,s.d=function(e,n,o){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)s.d(o,t,function(n){return e[n]}.bind(null,t));return o},s.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="",s(s.s=7)}([function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OWWindow=void 0;n.OWWindow=class{constructor(e=null){this._name=e,this._id=null}async restore(){let e=this;return console.log("window: restored"),new Promise(async n=>{await e.assureObtained();let s=e._id;overwolf.windows.restore(s,e=>{e.success||console.error(`[restore] - an error occurred, windowId=${s}, reason=${e.error}`),n()})})}async minimize(){let e=this;return console.log("window: minimized"),new Promise(async n=>{await e.assureObtained();let s=e._id;return overwolf.windows.minimize(s,()=>{}),n()})}async bringToFront(){let e=this;return console.log("window: minimized"),new Promise(async n=>{await e.assureObtained();let s=e._id;return overwolf.windows.bringToFront(s,!0,()=>{}),n()})}async maximize(){let e=this;return console.log("window: maximized"),new Promise(async n=>{await e.assureObtained();let s=e._id;return overwolf.windows.maximize(s,()=>{}),n()})}async hide(){let e=this;return console.log("window: hidden"),new Promise(async n=>{await e.assureObtained();let s=e._id;return overwolf.windows.hide(s,()=>{}),n()})}async close(){let e=this;return new Promise(async n=>{await e.assureObtained();e._id;const s=await this.getWindowState();return s.success||console.error(s),s.success&&"closed"!==s.window_state&&await this.internalClose(),n()})}async changeWindowSize(e,n,s){overwolf.windows.changeSize(e,n,s,e=>{e.success||console.error(e)})}async changeWindowLocation(e,n){overwolf.windows.getCurrentWindow(s=>{s.success||console.error(s);let o=s.window.width,t=s.window.height;overwolf.utils.getMonitorsList(i=>{s.success||console.error(s);let a,r,w=i.displays[0].width,d=i.displays[0].height;"center-center"==e?(a=w/2-o/2,r=d/2-t/2):"center-right"==e?(a=w-o-20,r=d/2-t/2):"center-left"==e&&(a=20,r=d/2-t/2),overwolf.windows.changePosition(n,Math.round(a),Math.round(r),e=>{e.success||console.error(e)})})})}dragMove(e){e.onmousedown=e=>{e.preventDefault(),overwolf.windows.dragMove(this._name)}}async getWindowState(){let e=this;return new Promise(async n=>{await e.assureObtained();let s=e._id;overwolf.windows.getWindowState(s,n)})}static async getCurrentInfo(){return new Promise(async e=>{overwolf.windows.getCurrentWindow(n=>{e(n.window)})})}obtain(){return new Promise((e,n)=>{const s=s=>{s&&"success"===s.status&&s.window&&s.window.id?(this._id=s.window.id,this._name||(this._name=s.window.name),e(s.window)):(this._id=null,n())};this._name?overwolf.windows.obtainDeclaredWindow(this._name,s):overwolf.windows.getCurrentWindow(s)})}async assureObtained(){let e=this;return new Promise(async n=>(await e.obtain(),n()))}async internalClose(){let e=this;return new Promise(async(n,s)=>{await e.assureObtained();let o=e._id;overwolf.windows.close(o,e=>{e&&e.success?n():s(e)})})}}},function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tableStats=n.gameModesPVE=n.gameModesPVP=n.hotkeys=n.windowNames=n.interestingFeatures2=n.interestingFeatures1=n.rainbowClassId=void 0;n.rainbowClassId=10826;n.interestingFeatures1=["gep_internal","game_info","match","match_info","roster","kill","death","me"];n.interestingFeatures2=["gep_internal","game_info","match","match_info"];n.windowNames={desktop:"desktop",inLobby:"in_lobby",inGame:"in_game",inLobbyDesktopOnly:"in_lobby_desktop_only",inGameDesktopOnly:"in_game_desktop_only"};n.hotkeys={toggle:"showhide"};n.gameModesPVE=["OPERATIONS","MATCHMAKING_PVE_LONEWOLF","MATCHMAKING_PVE","MATCHMAKING_PVE_PARTY"];n.gameModesPVP=["MATCHMAKING_PVP_NEWCOMER","MATCHMAKING_PVP","MATCHMAKING_PVP_EVENT","MATCHMAKING_PVP_UNRANKED","MATCHMAKING_PVP_RANKED","CUSTOMGAME_PVP","CUSTOMGAME_PVP_DEDICATED"];n.tableStats=["rankedpvp_kills","rankedpvp_death","rankedpvp_matchwon","rankedpvp_matchlost","casualpvp_kills","casualpvp_death","casualpvp_matchwon","casualpvp_matchlost","kills","deaths","wins","losses"]},function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OWGamesEvents=void 0;const o=s(3);n.OWGamesEvents=class{constructor(e,n){this.onInfoUpdates=e=>{this._delegate.onInfoUpdates(e.info)},this.onNewEvents=e=>{this._delegate.onNewEvents(e)},this._delegate=e,this._requiredFeatures=n}async getInfo(){return new Promise(e=>{overwolf.games.events.getInfo(e)})}async setRequiredFeatures(){let e,n=1;for(;n>0;){if(e=await new Promise(e=>{overwolf.games.events.setRequiredFeatures(this._requiredFeatures,e)}),"success"===e.status)return console.log("setRequiredFeatures(): success: "+JSON.stringify(e,null,2)),e.supportedFeatures.length>0;await o.Timer.wait(3e3),n++}return console.warn("setRequiredFeatures(): failure after "+n+" tries"+JSON.stringify(e,null,2)),!1}registerEvents(){this.unRegisterEvents(),overwolf.games.events.onInfoUpdates2.addListener(this.onInfoUpdates),overwolf.games.events.onNewEvents.addListener(this.onNewEvents)}unRegisterEvents(){overwolf.games.events.onInfoUpdates2.removeListener(this.onInfoUpdates),overwolf.games.events.onNewEvents.removeListener(this.onNewEvents)}async start(){console.log("[ow-game-events] START"),this.registerEvents(),await this.setRequiredFeatures();const{res:e,status:n}=await this.getInfo();e&&"success"===n&&this.onInfoUpdates({info:e})}stop(){console.log("[ow-game-events] STOP"),this.unRegisterEvents()}}},function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Timer=void 0;n.Timer=class{constructor(e,n){this._timerId=null,this.handleTimerEvent=()=>{this._timerId=null,this._delegate.onTimer(this._id)},this._delegate=e,this._id=n}static async wait(e){return new Promise(n=>{setTimeout(n,e)})}start(e){this.stop(),this._timerId=setTimeout(this.handleTimerEvent,e)}stop(){null!=this._timerId&&(clearTimeout(this._timerId),this._timerId=null)}}},,,,function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=s(1),t=s(8),i=s(9),a=s(0),r=s(2);let w,d,l;function m(e,n,s){const o='"'+n+'": '+JSON.stringify(s,void 0,2);"log"===e?console.log(o):"error"===e?console.error(o):"warn"===e&&console.warn(o)}class c{constructor(){this._windows={},this._windows[o.windowNames.desktop]=new a.OWWindow(o.windowNames.desktop),this._windows[o.windowNames.inGame]=new a.OWWindow(o.windowNames.inGame),this._windows[o.windowNames.inLobby]=new a.OWWindow(o.windowNames.inLobby),this._windows[o.windowNames.inGameDesktopOnly]=new a.OWWindow(o.windowNames.inGameDesktopOnly),this._windows[o.windowNames.inLobbyDesktopOnly]=new a.OWWindow(o.windowNames.inLobbyDesktopOnly),this._rainbowGameListener=new i.OWGameListener({onGameStarted:this.toggleWindows.bind(this),onGameEnded:this.toggleWindows.bind(this)}),this._rainbowGameEventsListener=new r.OWGamesEvents({onInfoUpdates:this.onInfoUpdates.bind(this),onNewEvents:this.onNewEvents.bind(this)},o.interestingFeatures2)}static instance(){return c._instance||(c._instance=new c),c._instance}async run(){this._rainbowGameEventsListener.start(),this._rainbowGameListener.start();const e=await this.isRainbowRunning()?null:this._windows[o.windowNames.desktop].restore();e&&(m("log","open window",e),l=e)}toggleWindows(e){if(e&&this.isGameRainbow(e))if(e.isRunning)this._windows[o.windowNames.desktop].close(),m("log","close window",o.windowNames.desktop);else{this._windows[o.windowNames.inGame].close().then(e=>this._windows[o.windowNames.inLobby].close()).then(e=>this._windows[o.windowNames.inGameDesktopOnly].close()).then(e=>this._windows[o.windowNames.inLobbyDesktopOnly].close()).then(e=>this._windows[o.windowNames.desktop].restore());m("log","close window",o.windowNames.inGame),m("log","close window",o.windowNames.inLobby),m("log","close window",o.windowNames.inGameDesktopOnly),m("log","close window",o.windowNames.inLobbyDesktopOnly),m("log","open window",o.windowNames.desktop),l="desktop"}}async isRainbowRunning(){const e=await t.OWGames.getRunningGameInfo();return e&&e.isRunning&&this.isGameRainbow(e)}isGameRainbow(e){return e.classId===o.rainbowClassId}onInfoUpdates(e){if(m("log","infoEvent",e),"match_info"in e&&"game_mode"in e.match_info||"game_info"in e&&"phase"in e.game_info&&"lobby"===e.game_info.phase)if(e.match_info&&(w=e.match_info.game_mode),"NONE"!==w)d="searching";else if(d="lobby",'"0"'===localStorage.desktopOnly){this._windows[o.windowNames.inGame].close().then(e=>this._windows[o.windowNames.inGameDesktopOnly].close()).then(e=>this._windows[o.windowNames.inLobby].restore());m("log","close window",o.windowNames.inGame),m("log","close window",o.windowNames.inGameDesktopOnly),m("log","open window",o.windowNames.inLobby)}else{this._windows[o.windowNames.inGameDesktopOnly].close().then(e=>this._windows[o.windowNames.inGame].close()).then(e=>this._windows[o.windowNames.inLobbyDesktopOnly].restore());m("log","close window",o.windowNames.inGameDesktopOnly),m("log","close window",o.windowNames.inGame),m("log","open window",o.windowNames.inLobbyDesktopOnly)}if("round"in e&&null!=e.round.number&&"in_game"!==d)if(d="in_game",'"0"'===localStorage.desktopOnly){this._windows[o.windowNames.inLobby].close().then(e=>this._windows[o.windowNames.inLobbyDesktopOnly].close()).then(e=>this._windows[o.windowNames.inGame].restore());m("log","close window",o.windowNames.inLobby),m("log","close window",o.windowNames.inLobbyDesktopOnly),m("log","open window",o.windowNames.inGame)}else{this._windows[o.windowNames.inLobbyDesktopOnly].close().then(e=>this._windows[o.windowNames.inLobby].close()).then(e=>this._windows[o.windowNames.inGameDesktopOnly].restore());m("log","close window",o.windowNames.inLobbyDesktopOnly),m("log","close window",o.windowNames.inLobby),m("log","open window",o.windowNames.inGameDesktopOnly)}}onNewEvents(e){m("log","infoEvent",e)}}c.instance().run()},function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OWGames=void 0;n.OWGames=class{static getRunningGameInfo(){return new Promise(e=>{overwolf.games.getRunningGameInfo(e)})}static classIdFromGameId(e){return Math.floor(e/10)}static async getRecentlyPlayedGames(e=3){return new Promise(n=>{if(!overwolf.games.getRecentlyPlayedGames)return n(null);overwolf.games.getRecentlyPlayedGames(e,e=>{n(e.games)})})}static async getGameDBInfo(e){return new Promise(n=>{overwolf.games.getGameDBInfo(e,n)})}}},function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OWGameListener=void 0;const o=s(10);class t extends o.OWListener{constructor(e){super(e),this.onGameInfoUpdated=e=>{e&&e.gameInfo&&(e.runningChanged||e.gameChanged)&&(e.gameInfo.isRunning?this._delegate.onGameStarted&&this._delegate.onGameStarted(e.gameInfo):this._delegate.onGameEnded&&this._delegate.onGameEnded(e.gameInfo))},this.onRunningGameInfo=e=>{e&&e.isRunning&&this._delegate.onGameStarted&&this._delegate.onGameStarted(e)}}start(){super.start(),overwolf.games.onGameInfoUpdated.addListener(this.onGameInfoUpdated),overwolf.games.getRunningGameInfo(this.onRunningGameInfo)}stop(){overwolf.games.onGameInfoUpdated.removeListener(this.onGameInfoUpdated)}}n.OWGameListener=t},function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.OWListener=void 0;n.OWListener=class{constructor(e){this._delegate=e}start(){this.stop()}}}]);
